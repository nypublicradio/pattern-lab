/*------------------------------------*\
    $BLOCKS
\*------------------------------------*/


@mixin block-hover {
  color: $c-primary;
  text-decoration: underline;
  text-decoration-style: dotted;
  // background-image: linear-gradient(to right, $c-primary 50%, transparent 50%);
  // background-position: left bottom .22em;
  // background-repeat: repeat-x;
  // background-size: 12px 2px;
}

@mixin dot-divider {
  content: "â€¢";
  display: inline-block;
  margin-right: $space-half;
  margin-left: -$space-quarter;
  color: $c-gray;
  font-size: 18px;
  transform: translateY(.08em);
}

/**
 * Standard block
 */
.c-block {

  &__media {
    margin-bottom: $space-half;
    text-align: right;

    &:hover + .c-block__object .c-block__title-link,
    &:hover .c-block__title-link {
      @include block-hover;
    }
  }

  &__tag {
    color: $c-white;
    background-color: $c-primary;
    vertical-align: top;
    position: relative;
    top: 1px;

    &:hover {
      background-color: $c-tertiary;
    }
  }

  &__title {
    font-weight: bold;
    font-size: $font-size-m;

    &--has-icon {
      &:after {
        content: "";
        display: inline-block;
        width: $icon-small;
        height: $icon-small;
        margin-left: $space-half;
        vertical-align: middle;
      }
    }

    // @TODO: Get the colors to populate using the sass vars.
    &--is-gallery {
      &:after {
        margin-bottom: .2em;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3E%3Ctitle%3EGallery Icon%3C/title%3E%3Cpath d='M7.37,7.61l-4.29.45a.62.62,0,0,0-.58.6V22.1a.63.63,0,0,0,.65.61h23.7a.63.63,0,0,0,.65-.61V12.54H16.05C12.15,12.54,9,10.77,7.37,7.61ZM7.88,5a.63.63,0,0,1,.19,0c1.88-.13,3.77-.21,5.65-.23q4.35,0,8.72.28l4.73.49A3.16,3.16,0,0,1,30,8.66V22.1a3.17,3.17,0,0,1-3.15,3.18H3.15A3.17,3.17,0,0,1,0,22.1V8.66A3.18,3.18,0,0,1,2.83,5.5L7.58,5l.3,0ZM27.46,8.72a.63.63,0,0,0-.58-.61l-4.77-.5a95.3,95.3,0,0,0-11.83-.17,7.05,7.05,0,0,0,5.77,2.5H27.46Zm-11,9A1.44,1.44,0,0,0,15,16.23h0a1.44,1.44,0,0,0-1.42,1.45h0a1.42,1.42,0,1,0,2.84,0Zm2.84,0A4.26,4.26,0,1,1,15,13.31,4.32,4.32,0,0,1,19.26,17.68ZM5.05,16.32a1.49,1.49,0,0,1-1.47-1.51h0a1.49,1.49,0,0,1,1.47-1.5H9.44a1.51,1.51,0,0,1,0,3H5.05Z' fill='%23f25917' fill-rule='evenodd'/%3E%3C/svg%3E");
      }
    }

    &--is-outbound-link {
      &:after {
        width: $icon-xsmall;
        height: $icon-xsmall;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3E%3Cpath d='M15.46,3.45V0H30V14.54H26.55V5.89L17,15.44,14.56,13l9.55-9.56Z'/%3E%3Cpath d='M20,26.38V14.56h3.62V30H0V6.43H15.44v3.62H3.62V26.38Z'/%3E%3C/svg%3E%0A");
        opacity: .5;
        margin-bottom: .3em;
      }
    }

    a {
      color: $c-black;
      transition: none;

      &:hover {
        @include block-hover;
      }
    }
  }

  &__object {
    padding-top: $space-half;
  }

  &__dek {
    p {
      line-height: 1.45;

      @include media('<=medium') {
        font-size: $font-size-s;
      }
    }
  }
}


/**
 * Inline blocks (often used in lists)
 */
.c-block--horizontal {
  display: flex;
  align-items: flex-start;

  .c-block__media {
    min-width: 100px;
    max-width: 100px;
    overflow: hidden;
    margin-bottom: 0;

    @include media('>xlarge') {
      min-width: 150px;
      max-width: 150px;
    }
  }

  .c-block__title {
    font-size: $font-size-s-m;
  }

  .c-block__object {
    padding: 0 0 0 $space;
    width: 100%;
  }

  // Larger versions of horizontal blocks
  &--large {

    .c-block__media {
      @include media('>medium') {
        min-width: 360px;
        max-width: 360px;

        img {
          height: auto;
          width: 100%;
        }
      }
    }

    .c-block__title {
      @include media('>medium') {
        font-size: $font-size-l;
      }
    }

    .c-block__object {
      @include media('>medium') {
        padding-left: $space-and-half;
      }
    }
  }
}


/**
 * Block meta
 */
.c-block-meta {

  > * + * {
    &:before {
      @include dot-divider;
    }
  }

  &__comments {
    display: inline-flex;
    align-items: center;
    margin-left: $space-half;

    &:hover {
      color: $c-primary;

      .o-icon--comment {
        fill: $c-primary;
      }
    }

    .o-icon--comment {
      margin-right: $space-quarter;
      fill: $c-body-color;
    }
  }
}


/**
 * Author block
 */
$author-media-width-s: 250;
$author-media-width-l: 360;
.c-author-block {
  position: relative;
  overflow: auto;

  &__meta {
    position: relative;
    margin-bottom: $space-half;

    @include media('>small') {
      margin-top: $space-half;
    }
  }

  &__title {
    @include media('>large') {
      font-size: $font-size-l;
    }
  }

  &__role {

    &:after {
      @include media('>small') {
        @include dot-divider;
        margin: 0 $space-half;
      }
    }
  }

  &__social {

    @include media('>small') {
      margin-left: -$space-half;
      margin-bottom: $space-half;
    }
    .c-share-tools__link {
      margin-right: $space-half;
    }
  }

  &__details {
    @include media('<=small') {
      position: absolute;
      right: 0;
      bottom: $space-half;
    }
  }

  &__media {
    margin-bottom: $space-half;

    @include media('>small') {
      max-width: $author-media-width-s + px;
      float: left;
    }

    @include media('>large') {
      max-width: $author-media-width-l + px;
    }
  }

  &__meta,
  &__object {
    @include media('>small') {
      width: calc(100% - #{$author-media-width-s}px - #{$space});
      float: right;
    }

    @include media('>large') {
      width: calc(100% - #{$author-media-width-l}px - #{$space});
    }
  }

  &__dek {

    p {
      display: inline;

      &:not(:first-child) {
        display: none;
      }
    }

    .o-icon {
      width: 12px;
      height: 12px;
      fill: $c-secondary;
    }

    &.this-is-active {
      p {
        display: block;
      }
    }
  }

  .c-author-block__dek-toggle {
    margin: 0;
  }

  &__dek-toggle {
    align-items: center;

    &.this-is-active {
      display: inline-flex;

      .o-icon {
        transform: rotate(180deg);
      }
    }
  }
}
